{"version":3,"file":"form_dependent_select.min.js","sources":["../src/form_dependent_select.js"],"sourcesContent":["export const init = (choices) => {\n    var selectseries = document.getElementById('id_series');\n    var selectepisodes = document.getElementById('id_episode');\n\n    selectseries.addEventListener('change', function() {\n        var series = this.value;\n        document.getElementById('id_ocinstanceid').value = this.value.substring(this.value.lastIndexOf('_') + 1, this.value.length);\n        document.getElementById('id_opencastid').value = this.value.substring(0, this.value.lastIndexOf('_'));\n        document.getElementById('id_opencastid').dispatchEvent(new Event('change'));\n\n        Array.from(selectepisodes.options).forEach(function(option) {\n            if (option.value in choices[series]) {\n                option.hidden = false;\n                option.hidden = false;\n            } else {\n                option.hidden = true;\n                option.hidden = true;\n            }\n        });\n        selectepisodes.value = 'allvideos';\n    });\n\n    selectepisodes.addEventListener('change', function() {\n        document.getElementById('id_opencastid').value = this.value;\n        document.getElementById('id_opencastid').dispatchEvent(new Event('change'));\n    });\n\n    // Initialize select values.\n    var initOpencastid = document.getElementById('id_opencastid').value;\n    if (initOpencastid) {\n        selectepisodes.value = initOpencastid;\n        var foundseries = false;\n        for (const [seriesid, episodes] of Object.entries(choices)) {\n            // Skip series from wrong Opencast instance.\n            if (seriesid.substring(seriesid.lastIndexOf('_') + 1, seriesid.length) !==\n                document.getElementById('id_ocinstanceid').value) {\n                continue;\n            }\n\n            // ID is series.\n            if (initOpencastid === seriesid.substring(0, seriesid.lastIndexOf('_'))) {\n                selectseries.value = seriesid;\n                selectepisodes.value = 'allvideos';\n                foundseries = true;\n                break;\n            }\n\n            if (initOpencastid in episodes) {\n                selectseries.value = seriesid;\n                foundseries = true;\n                break;\n            }\n        }\n        if (!foundseries) {\n            selectseries.value = 'invalid';\n        }\n\n    } else {\n        // Use defaults if there are any.\n        if (selectseries.options.length > 0) {\n            selectseries.dispatchEvent(new Event('change'));\n        }\n    }\n\n    // Disabled values should also be submitted in this case.\n    selectseries.form.addEventListener(\"submit\", function() {\n        document.getElementById('id_opencastid').disabled = false;\n        document.getElementById('id_ocinstanceid').disabled = false;\n    });\n};"],"names":["choices","selectseries","document","getElementById","selectepisodes","addEventListener","series","this","value","substring","lastIndexOf","length","dispatchEvent","Event","Array","from","options","forEach","option","hidden","initOpencastid","foundseries","seriesid","episodes","Object","entries","form","disabled"],"mappings":"uKAAqBA,cACbC,aAAeC,SAASC,eAAe,aACvCC,eAAiBF,SAASC,eAAe,cAE7CF,aAAaI,iBAAiB,UAAU,eAChCC,OAASC,KAAKC,MAClBN,SAASC,eAAe,mBAAmBK,MAAQD,KAAKC,MAAMC,UAAUF,KAAKC,MAAME,YAAY,KAAO,EAAGH,KAAKC,MAAMG,QACpHT,SAASC,eAAe,iBAAiBK,MAAQD,KAAKC,MAAMC,UAAU,EAAGF,KAAKC,MAAME,YAAY,MAChGR,SAASC,eAAe,iBAAiBS,cAAc,IAAIC,MAAM,WAEjEC,MAAMC,KAAKX,eAAeY,SAASC,SAAQ,SAASC,QAC5CA,OAAOV,SAASR,QAAQM,SACxBY,OAAOC,QAAS,EAChBD,OAAOC,QAAS,IAEhBD,OAAOC,QAAS,EAChBD,OAAOC,QAAS,MAGxBf,eAAeI,MAAQ,eAG3BJ,eAAeC,iBAAiB,UAAU,WACtCH,SAASC,eAAe,iBAAiBK,MAAQD,KAAKC,MACtDN,SAASC,eAAe,iBAAiBS,cAAc,IAAIC,MAAM,kBAIjEO,eAAiBlB,SAASC,eAAe,iBAAiBK,SAC1DY,eAAgB,CAChBhB,eAAeI,MAAQY,mBACnBC,aAAc,MACb,MAAOC,SAAUC,YAAaC,OAAOC,QAAQzB,YAE1CsB,SAASb,UAAUa,SAASZ,YAAY,KAAO,EAAGY,SAASX,UAC3DT,SAASC,eAAe,mBAAmBK,UAK3CY,iBAAmBE,SAASb,UAAU,EAAGa,SAASZ,YAAY,MAAO,CACrET,aAAaO,MAAQc,SACrBlB,eAAeI,MAAQ,YACvBa,aAAc,WAIdD,kBAAkBG,SAAU,CAC5BtB,aAAaO,MAAQc,SACrBD,aAAc,SAIjBA,cACDpB,aAAaO,MAAQ,gBAKrBP,aAAae,QAAQL,OAAS,GAC9BV,aAAaW,cAAc,IAAIC,MAAM,WAK7CZ,aAAayB,KAAKrB,iBAAiB,UAAU,WACzCH,SAASC,eAAe,iBAAiBwB,UAAW,EACpDzB,SAASC,eAAe,mBAAmBwB,UAAW"}