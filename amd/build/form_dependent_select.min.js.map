{"version":3,"sources":["../src/form_dependent_select.js"],"names":["init","choices","selectseries","document","getElementById","selectepisodes","addEventListener","series","value","substring","lastIndexOf","length","dispatchEvent","Event","Array","from","options","forEach","option","hidden","initOpencastid","foundseries","Object","entries","seriesid","episodes","form","disabled"],"mappings":"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","sourcesContent":["export const init = (choices) => {\n    var selectseries = document.getElementById('id_series');\n    var selectepisodes = document.getElementById('id_episode');\n\n    selectseries.addEventListener('change', function() {\n        var series = this.value;\n        document.getElementById('id_ocinstanceid').value = this.value.substring(this.value.lastIndexOf('_') + 1, this.value.length);\n        document.getElementById('id_opencastid').value = this.value.substring(0, this.value.lastIndexOf('_'));\n        document.getElementById('id_opencastid').dispatchEvent(new Event('change'));\n\n        Array.from(selectepisodes.options).forEach(function(option) {\n            if (option.value in choices[series]) {\n                option.hidden = false;\n                option.hidden = false;\n            } else {\n                option.hidden = true;\n                option.hidden = true;\n            }\n        });\n        selectepisodes.value = 'allvideos';\n    });\n\n    selectepisodes.addEventListener('change', function() {\n        document.getElementById('id_opencastid').value = this.value;\n        document.getElementById('id_opencastid').dispatchEvent(new Event('change'));\n    });\n\n    // Initialize select values.\n    var initOpencastid = document.getElementById('id_opencastid').value;\n    if (initOpencastid) {\n        selectepisodes.value = initOpencastid;\n        var foundseries = false;\n        for (const [seriesid, episodes] of Object.entries(choices)) {\n            // Skip series from wrong Opencast instance.\n            if (seriesid.substring(seriesid.lastIndexOf('_') + 1, seriesid.length) !==\n                document.getElementById('id_ocinstanceid').value) {\n                continue;\n            }\n\n            // ID is series.\n            if (initOpencastid === seriesid.substring(0, seriesid.lastIndexOf('_'))) {\n                selectseries.value = seriesid;\n                selectepisodes.value = 'allvideos';\n                foundseries = true;\n                break;\n            }\n\n            if (initOpencastid in episodes) {\n                selectseries.value = seriesid;\n                foundseries = true;\n                break;\n            }\n        }\n        if (!foundseries) {\n            selectseries.value = 'invalid';\n        }\n\n    } else {\n        // Use defaults if there are any.\n        if (selectseries.options.length > 0) {\n            selectseries.dispatchEvent(new Event('change'));\n        }\n    }\n\n    // Disabled values should also be submitted in this case.\n    selectseries.form.addEventListener(\"submit\", function() {\n        document.getElementById('id_opencastid').disabled = false;\n        document.getElementById('id_ocinstanceid').disabled = false;\n    });\n};"],"file":"form_dependent_select.min.js"}